(function(window){"use strict";if(window.hasOwnProperty("speechSynthesis")){speechSynthesis.getVoices()}if(window.hasOwnProperty("webkitSpeechRecognition")){var reconocimiento=new webkitSpeechRecognition}var artyomProperties={lang:"en-GB",recognizing:false,continuous:false,speed:1,volume:1,listen:false,mode:"normal",debug:false,helpers:{redirectRecognizedTextOutput:null,remoteProcessorHandler:null,lastSay:null},executionKeyword:null,obeyKeyword:null,speaking:false,obeying:true,soundex:false};var artyom_garbage_collector=[];var artyomFlags={restartRecognition:false};var artyomLanguages={german:["Google Deutsch","de-DE","de_DE"],spanish:["Google español","es-ES","es_ES","es-MX","es_MX"],italian:["Google italiano","it-IT","it_IT"],japanese:["Google 日本人","ja-JP","ja_JP"],englishUSA:["Google US English","en-US","en_US"],englishGB:["Google UK English Female","en-GB","en_GB"],brasilian:["Google português do Brasil","pt-PT","pt-BR","pt_PT","pt_BR"],russia:["Google русский","ru-RU","ru_RU"],holand:["Google Nederlands","nl-NL","nl_NL"],france:["Google français","fr-FR","fr_FR"],polski:["Google polski","pl-PL","pl_PL"],indonesia:["Google Bahasa Indonesia","id-ID","id_ID"],hindi:["Google हिन्दी","hi-IN","hi_IN"],mandarinChinese:["Google 普通话（中国大陆）","zh-CN","zh_CN"],cantoneseChinese:["Google 粤語（香港）","zh-HK","zh_HK"],native:["native"]};var artyom_global_events={ERROR:"ERROR",SPEECH_SYNTHESIS_START:"SPEECH_SYNTHESIS_START",SPEECH_SYNTHESIS_END:"SPEECH_SYNTHESIS_END",TEXT_RECOGNIZED:"TEXT_RECOGNIZED",COMMAND_RECOGNITION_START:"COMMAND_RECOGNITION_START",COMMAND_RECOGNITION_END:"COMMAND_RECOGNITION_END",COMMAND_MATCHED:"COMMAND_MATCHED",NOT_COMMAND_MATCHED:"NOT_COMMAND_MATCHED"};var artyomVoice={default:false,lang:"en-GB",localService:false,name:"Google UK English Male",voiceURI:"Google UK English Male"};var device={isMobile:false,isChrome:true};if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){device.isMobile=true}if(navigator.userAgent.indexOf("Chrome")==-1){device.isChrome=false}function ArtyomInternals(){this.getVoice=function(languageCode){var voiceIdentifiersArray=[];switch(languageCode){case"de-DE":voiceIdentifiersArray=artyomLanguages.german;break;case"en-GB":voiceIdentifiersArray=artyomLanguages.englishGB;break;case"pt-BR":case"pt-PT":voiceIdentifiersArray=artyomLanguages.brasilian;break;case"ru-RU":voiceIdentifiersArray=artyomLanguages.russia;break;case"nl-NL":voiceIdentifiersArray=artyomLanguages.holand;break;case"es-ES":voiceIdentifiersArray=artyomLanguages.spanish;break;case"en-US":voiceIdentifiersArray=artyomLanguages.englishUSA;break;case"fr-FR":voiceIdentifiersArray=artyomLanguages.france;break;case"it-IT":voiceIdentifiersArray=artyomLanguages.italian;break;case"ja-JP":voiceIdentifiersArray=artyomLanguages.japanese;break;case"id-ID":voiceIdentifiersArray=artyomLanguages.indonesia;break;case"hi-IN":voiceIdentifiersArray=artyomLanguages.hindi;break;case"pl-PL":voiceIdentifiersArray=artyomLanguages.polski;break;case"zh-CN":voiceIdentifiersArray=artyomLanguages.mandarinChinese;break;case"zh-HK":voiceIdentifiersArray=artyomLanguages.cantoneseChinese;break;case"native":voiceIdentifiersArray=artyomLanguages.native;break;default:console.warn("The given language '"+languageCode+"' for artyom is not supported yet. Using native voice instead");break}var voice=undefined;var voices=speechSynthesis.getVoices();var voicesLength=voiceIdentifiersArray.length;for(var i=0;i<voicesLength;i++){var foundVoice=voices.filter(function(voice){return voice.name==voiceIdentifiersArray[i]||voice.lang==voiceIdentifiersArray[i]})[0];if(foundVoice){voice=foundVoice;break}}return voice};this.soundex=function(s){var a=s.toLowerCase().split(""),f=a.shift(),r="",codes={a:"",e:"",i:"",o:"",u:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,d:3,t:3,l:4,m:5,n:5,r:6};r=f+a.map(function(v,i,a){return codes[v]}).filter(function(v,i,a){return i===0?v!==codes[f]:v!==a[i-1]}).join("");return(r+"000").slice(0,4).toUpperCase()}}function Artyom(){var artyom={};var artyomCommands=[];var artyomInternals=new ArtyomInternals;artyom.device=device;artyom.getVoices=function(){return window.speechSynthesis.getVoices()};artyom.getAvailableCommands=function(){return artyomCommands};artyom.initialize=function(config){if(typeof config!=="object"){return Promise.reject("You must give the configuration for start artyom properly.")}if(config.hasOwnProperty("lang")){artyomVoice=artyomInternals.getVoice(config.lang);artyomProperties.lang=config.lang}if(config.hasOwnProperty("continuous")){if(config.continuous){artyomProperties.continuous=true;artyomFlags.restartRecognition=true}else{artyomProperties.continuous=false;artyomFlags.restartRecognition=false}}if(config.hasOwnProperty("speed")){artyomProperties.speed=config.speed}if(config.hasOwnProperty("soundex")){artyomProperties.soundex=config.soundex}if(config.hasOwnProperty("executionKeyword")){artyomProperties.executionKeyword=config.executionKeyword}if(config.hasOwnProperty("obeyKeyword")){artyomProperties.obeyKeyword=config.obeyKeyword}if(config.hasOwnProperty("volume")){artyomProperties.volume=config.volume}if(config.hasOwnProperty("listen")){artyomProperties.listen=config.listen}if(config.hasOwnProperty("debug")){artyomProperties.debug=config.debug}else{console.warn("The initialization doesn't provide how the debug mode should be handled. Is recommendable to set this value either to true or false.")}if(config.mode){artyomProperties.mode=config.mode}if(artyomProperties.listen===true){return new Promise(function(resolve,reject){artyom_hey(resolve,reject)})}return Promise.resolve()};artyom.fatality=function(){try{artyomFlags.restartRecognition=false;reconocimiento.stop();return true}catch(e){console.log(e);return false}};artyom.addCommands=function(param){var _processObject=function(obj){if(obj.hasOwnProperty("indexes")){artyomCommands.push(obj)}else{console.error("The following command doesn't provide any index to execute :");console.dir(obj)}};if(param instanceof Array){for(var i=0;i<param.length;i++){_processObject(param[i])}}else{_processObject(param)}return true};artyom.removeCommands=function(identifier){if(typeof identifier==="string"){var toDelete=[];for(var i=0;i<artyomCommands.length;i++){var command=artyomCommands[i];if(command.indexes.indexOf(identifier)){toDelete.push(i)}}for(var o=0;o<toDelete.length;o++){artyomCommands.splice(o,1)}}return toDelete};artyom.emptyCommands=function(){return artyomCommands=[]};artyom.shutUp=function(){if("speechSynthesis"in window){do{window.speechSynthesis.cancel()}while(window.speechSynthesis.pending===true)}artyomProperties.speaking=false;artyom.clearGarbageCollection()};artyom.getProperties=function(){return artyomProperties};var artyom_triggerEvent=function(name,param){var event=new CustomEvent(name,{detail:param});document.dispatchEvent(event);return event};artyom.when=function(event,action){return document.addEventListener(event,function(e){action(e.detail)},false)};artyom.getLanguage=function(){return artyomProperties.lang};var artyom_talk=function(text,actualChunk,totalChunks,callbacks){var msg=new SpeechSynthesisUtterance;msg.text=text;msg.volume=artyomProperties.volume;msg.rate=artyomProperties.speed;if(artyomVoice){var availableVoice=undefined;if(callbacks){if(callbacks.hasOwnProperty("lang")){availableVoice=artyomInternals.getVoice(callbacks.lang)}else{availableVoice=artyomInternals.getVoice(artyomProperties.lang)}}else{availableVoice=artyomInternals.getVoice(artyomProperties.lang)}if(artyom.device.isMobile){if(availableVoice){msg.lang=availableVoice.lang}}else{msg.voice=availableVoice}}else{console.warn("No voice was selected during the initialization probably because there were no voices available. Initialize artyom after the onload event of the window.")}if(actualChunk==1){msg.addEventListener("start",function(){artyomProperties.speaking=true;artyom.debug("Event reached : "+artyom_global_events.SPEECH_SYNTHESIS_START);artyom_triggerEvent(artyom_global_events.SPEECH_SYNTHESIS_START);if(callbacks){if(typeof callbacks.onStart=="function"){callbacks.onStart.call(msg)}}})}if(actualChunk>=totalChunks){msg.addEventListener("end",function(){artyomProperties.speaking=false;artyom.debug("Event reached : "+artyom_global_events.SPEECH_SYNTHESIS_END);artyom_triggerEvent(artyom_global_events.SPEECH_SYNTHESIS_END);if(callbacks){if(typeof callbacks.onEnd=="function"){callbacks.onEnd.call(msg)}}})}artyom.debug(actualChunk+" text chunk processed succesfully out of "+totalChunks);artyom_garbage_collector.push(msg);window.speechSynthesis.speak(msg)};var splitStringByChunks=function(input,chunk_length){input=input||"";chunk_length=chunk_length||100;var curr=chunk_length;var prev=0;var output=[];while(input[curr]){if(input[curr++]==" "){output.push(input.substring(prev,curr));prev=curr;curr+=chunk_length}}output.push(input.substr(prev));return output};artyom.say=function(message,callbacks){var artyom_say_max_chunk_length=115;if(artyom.speechSupported()){if(typeof message=="string"){if(message.length>0){var definitive=[];if(message.length>artyom_say_max_chunk_length){var naturalReading=message.split(/,|:|\.|;/);naturalReading.forEach(function(chunk,index){if(chunk.length>artyom_say_max_chunk_length){var temp_processed=splitStringByChunks(chunk,artyom_say_max_chunk_length);definitive.push.apply(definitive,temp_processed)}else{definitive.push(chunk)}})}else{definitive.push(message)}definitive=definitive.filter(function(e){return e});definitive.forEach(function(chunk,index){var numberOfChunk=index+1;if(chunk){artyom_talk(chunk,numberOfChunk,definitive.length,callbacks)}});artyomProperties.helpers.lastSay={text:message,date:new Date}}else{console.warn("Artyom expects a string to say ... none given.")}}else{console.warn("Artyom expects a string to say ... "+typeof message+" given.")}}};artyom.repeatLastSay=function(returnObject){var last=artyomProperties.helpers.lastSay;if(returnObject){return last}else{if(last!=null){artyom.say(last.text)}}};artyom.speechSupported=function(){return"speechSynthesis"in window};artyom.recognizingSupported=function(){return"webkitSpeechRecognition"in window};var artyom_hey=function(resolve,reject){var start_timestamp;var artyom_is_allowed;if(artyom.device.isMobile){reconocimiento.continuous=false;reconocimiento.interimResults=false;reconocimiento.maxAlternatives=1}else{reconocimiento.continuous=true;reconocimiento.interimResults=true}reconocimiento.lang=artyomProperties.lang;reconocimiento.onstart=function(){artyom.debug("Event reached : "+artyom_global_events.COMMAND_RECOGNITION_START);artyom_triggerEvent(artyom_global_events.COMMAND_RECOGNITION_START);artyomProperties.recognizing=true;artyom_is_allowed=true;resolve()};reconocimiento.onerror=function(event){reject(event.error);artyom_triggerEvent(artyom_global_events.ERROR,{code:event.error});if(event.error=="audio-capture"){artyom_is_allowed=false}if(event.error=="not-allowed"){artyom_is_allowed=false;if(event.timeStamp-start_timestamp<100){artyom_triggerEvent(artyom_global_events.ERROR,{code:"info-blocked",message:"Artyom needs the permision of the microphone, is blocked."})}else{artyom_triggerEvent(artyom_global_events.ERROR,{code:"info-denied",message:"Artyom needs the permision of the microphone, is denied"})}}};reconocimiento.onend=function(){if(artyomFlags.restartRecognition===true){if(artyom_is_allowed===true){reconocimiento.start();artyom.debug("Continuous mode enabled, restarting","info")}else{console.error("Verify the microphone and check for the table of errors in sdkcarlos.github.io/sites/artyom.html to solve your problem. If you want to give your user a message when an error appears add an artyom listener")}artyom_triggerEvent(artyom_global_events.COMMAND_RECOGNITION_END,{code:"continuous_mode_enabled",message:"OnEnd event reached with continuous mode"})}else{artyom_triggerEvent(artyom_global_events.COMMAND_RECOGNITION_END,{code:"continuous_mode_disabled",message:"OnEnd event reached without continuous mode"})}artyomProperties.recognizing=false};var onResultProcessor;if(artyomProperties.mode=="normal"){onResultProcessor=function(event){if(!artyomCommands.length){artyom.debug("No commands to process in normal mode.");return}var cantidadResultados=event.results.length;artyom_triggerEvent(artyom_global_events.TEXT_RECOGNIZED);for(var i=event.resultIndex;i<cantidadResultados;++i){var identificated=event.results[i][0].transcript;if(event.results[i].isFinal){var comando=artyom_execute(identificated.trim());if(typeof artyomProperties.helpers.redirectRecognizedTextOutput==="function"){artyomProperties.helpers.redirectRecognizedTextOutput(identificated,true)}if(comando!==false&&artyomProperties.recognizing==true){artyom.debug("<< Executing Matching Recognition in normal mode >>","info");reconocimiento.stop();artyomProperties.recognizing=false;if(comando.wildcard){comando.objeto.action(comando.indice,comando.wildcard.item,comando.wildcard.full)}else{comando.objeto.action(comando.indice)}break}}else{if(typeof artyomProperties.helpers.redirectRecognizedTextOutput==="function"){artyomProperties.helpers.redirectRecognizedTextOutput(identificated,false)}if(typeof artyomProperties.executionKeyword==="string"){if(identificated.indexOf(artyomProperties.executionKeyword)!=-1){var comando=artyom_execute(identificated.replace(artyomProperties.executionKeyword,"").trim());if(comando!==false&&artyomProperties.recognizing==true){artyom.debug("<< Executing command ordered by ExecutionKeyword >>","info");reconocimiento.stop();artyomProperties.recognizing=false;if(comando.wildcard){comando.objeto.action(comando.indice,comando.wildcard.item,comando.wildcard.full)}else{comando.objeto.action(comando.indice)}break}}}artyom.debug("Normal mode : "+identificated)}}}}if(artyomProperties.mode=="quick"){onResultProcessor=function(event){if(!artyomCommands.length){artyom.debug("No commands to process.");return}var cantidadResultados=event.results.length;artyom_triggerEvent(artyom_global_events.TEXT_RECOGNIZED);for(var i=event.resultIndex;i<cantidadResultados;++i){var identificated=event.results[i][0].transcript;if(!event.results[i].isFinal){var comando=artyom_execute(identificated.trim());if(typeof artyomProperties.helpers.redirectRecognizedTextOutput==="function"){artyomProperties.helpers.redirectRecognizedTextOutput(identificated,true)}if(comando!==false&&artyomProperties.recognizing==true){artyom.debug("<< Executing Matching Recognition in quick mode >>","info");reconocimiento.stop();artyomProperties.recognizing=false;if(comando.wildcard){comando.objeto.action(comando.indice,comando.wildcard.item)}else{comando.objeto.action(comando.indice)}break}}else{var comando=artyom_execute(identificated.trim());if(typeof artyomProperties.helpers.redirectRecognizedTextOutput==="function"){artyomProperties.helpers.redirectRecognizedTextOutput(identificated,false)}if(comando!==false&&artyomProperties.recognizing==true){artyom.debug("<< Executing Matching Recognition in quick mode >>","info");reconocimiento.stop();artyomProperties.recognizing=false;if(comando.wildcard){comando.objeto.action(comando.indice,comando.wildcard.item)}else{comando.objeto.action(comando.indice)}break}}artyom.debug("Quick mode : "+identificated)}}}if(artyomProperties.mode=="remote"){onResultProcessor=function(event){var cantidadResultados=event.results.length;artyom_triggerEvent(artyom_global_events.TEXT_RECOGNIZED);if(typeof artyomProperties.helpers.remoteProcessorHandler!=="function"){return artyom.debug("The remoteProcessorService is undefined.","warn")}for(var i=event.resultIndex;i<cantidadResultados;++i){var identificated=event.results[i][0].transcript;artyomProperties.helpers.remoteProcessorHandler({text:identificated,isFinal:event.results[i].isFinal})}}}reconocimiento.onresult=function(event){if(artyomProperties.obeying){onResultProcessor(event)}else{if(!artyomProperties.obeyKeyword){return}var temporal="";var interim="";for(var i=0;i<event.results.length;++i){if(event.results[i].final){temporal+=event.results[i][0].transcript}else{interim+=event.results[i][0].transcript}}artyom.debug("Artyom is not obeying","warn");if(interim.indexOf(artyomProperties.obeyKeyword)>-1||temporal.indexOf(artyomProperties.obeyKeyword)>-1){artyomProperties.obeying=true}}};if(artyomProperties.recognizing){reconocimiento.stop();artyom.debug("Event reached : "+artyom_global_events.COMMAND_RECOGNITION_END);artyom_triggerEvent(artyom_global_events.COMMAND_RECOGNITION_END)}else{try{reconocimiento.start()}catch(e){artyom_triggerEvent(artyom_global_events.ERROR,{code:"recognition_overlap",message:"A webkitSpeechRecognition instance has been started while there's already running. Is recommendable to restart the Browser"})}}};artyom.simulateInstruction=function(sentence){if(!sentence||typeof sentence!=="string"){console.warn("Cannot execute a non string command");return false}var foundCommand=artyom_execute(sentence);if(typeof foundCommand==="object"){if(foundCommand.objeto){if(foundCommand.objeto.smart){artyom.debug("Smart command matches with simulation, executing","info");foundCommand.objeto.action(foundCommand.indice,foundCommand.wildcard.item,foundCommand.wildcard.full)}else{artyom.debug("Command matches with simulation, executing","info");foundCommand.objeto.action(foundCommand.indice)}return true}}else{console.warn("No command founded trying with "+sentence);return false}};var artyom_execute=function(voz){if(!voz){console.warn("Internal error: Execution of empty command");return false}artyom.debug(">> "+voz);for(var i=0;i<artyomCommands.length;i++){var instruction=artyomCommands[i];var opciones=instruction.indexes;var encontrado=-1;for(var c=0;c<opciones.length;c++){var opcion=opciones[c];if(!instruction.smart){continue}if(opcion instanceof RegExp){if(opcion.test(voz)){artyom.debug(">> REGEX "+opcion.toString()+" MATCHED AGAINST "+voz+" WITH INDEX "+c+" IN COMMAND ","info");encontrado=parseInt(c)}}else{if(opcion.indexOf("*")!=-1){var grupo=opcion.split("*");if(grupo.length>2){console.warn("Artyom found a smart command with "+(grupo.length-1)+" wildcards. Artyom only support 1 wildcard for each command. Sorry");continue}var before=grupo[0];var later=grupo[1];if(later==""||later==" "){if(voz.indexOf(before)!=-1||voz.toLowerCase().indexOf(before.toLowerCase())!=-1){var wildy=voz.replace(before,"");wildy=wildy.toLowerCase().replace(before.toLowerCase(),"");encontrado=parseInt(c)}}else{if(voz.indexOf(before)!=-1||voz.toLowerCase().indexOf(before.toLowerCase())!=-1){if(voz.indexOf(later)!=-1||voz.toLowerCase().indexOf(later.toLowerCase())!=-1){var wildy=voz.replace(before,"").replace(later,"");wildy=wildy.toLowerCase().replace(before.toLowerCase(),"").replace(later.toLowerCase(),"");wildy=wildy.toLowerCase().replace(later.toLowerCase(),"");encontrado=parseInt(c)}}}}else{console.warn("Founded command marked as SMART but have no wildcard in the indexes, remove the SMART for prevent extensive memory consuming or add the wildcard *")}}if(encontrado>=0){encontrado=parseInt(c);break}}if(encontrado>=0){artyom_triggerEvent(artyom_global_events.COMMAND_MATCHED);return{indice:encontrado,objeto:instruction,wildcard:{item:wildy,full:voz}}}}for(var i=0;i<artyomCommands.length;i++){var instruction=artyomCommands[i];var opciones=instruction.indexes;var encontrado=-1;for(var c=0;c<opciones.length;c++){var opcion=opciones[c];if(instruction.smart){continue}if(voz===opcion){artyom.debug(">> MATCHED FULL EXACT OPTION "+opcion+" AGAINST "+voz+" WITH INDEX "+c+" IN COMMAND ","info");encontrado=parseInt(c);break}else if(voz.toLowerCase()===opcion.toLowerCase()){artyom.debug(">> MATCHED OPTION CHANGING ALL TO LOWERCASE "+opcion+" AGAINST "+voz+" WITH INDEX "+c+" IN COMMAND ","info");encontrado=parseInt(c);break}}if(encontrado>=0){artyom_triggerEvent(artyom_global_events.COMMAND_MATCHED);return{indice:encontrado,objeto:instruction}}}for(var i=0;i<artyomCommands.length;i++){var instruction=artyomCommands[i];var opciones=instruction.indexes;var encontrado=-1;for(var c=0;c<opciones.length;c++){if(instruction.smart){continue}var opcion=opciones[c];if(voz.indexOf(opcion)>=0){artyom.debug(">> MATCHED INDEX EXACT OPTION "+opcion+" AGAINST "+voz+" WITH INDEX "+c+" IN COMMAND ","info");encontrado=parseInt(c);break}else if(voz.toLowerCase().indexOf(opcion.toLowerCase())>=0){artyom.debug(">> MATCHED INDEX OPTION CHANGING ALL TO LOWERCASE "+opcion+" AGAINST "+voz+" WITH INDEX "+c+" IN COMMAND ","info");encontrado=parseInt(c);break}}if(encontrado>=0){artyom_triggerEvent(artyom_global_events.COMMAND_MATCHED);return{indice:encontrado,objeto:instruction}}}if(artyomProperties.soundex){for(var i=0;i<artyomCommands.length;i++){var instruction=artyomCommands[i];var opciones=instruction.indexes;var encontrado=-1;for(var c=0;c<opciones.length;c++){var opcion=opciones[c];if(instruction.smart){continue}if(artyomInternals.soundex(voz)==artyomInternals.soundex(opcion)){artyom.debug(">> Matched Soundex command '"+opcion+"' AGAINST '"+voz+"' with index "+c,"info");encontrado=parseInt(c);artyom_triggerEvent(artyom_global_events.COMMAND_MATCHED);return{indice:encontrado,objeto:instruction}}}}}artyom.debug("Event reached : "+artyom_global_events.NOT_COMMAND_MATCHED);artyom_triggerEvent(artyom_global_events.NOT_COMMAND_MATCHED);return false};artyom.debug=function(e,o){if(artyomProperties.debug===true){switch(o){case"error":console.log(" %cArtyom.js "+" "+e,"background: #C12127; color: #FFFFFF");break;case"warn":console.warn(e);break;case"info":console.log(" %cArtyom.js: "+" "+e,"background: #4285F4; color: #FFFFFF");break;default:console.log(" %cArtyom.js %c "+" "+e,"background: #005454; color: #BFF8F8","color:black;");break}}};artyom.detectErrors=function(){if(window.location.protocol=="file:"){var message="Fatal Error Detected : It seems you're running the artyom demo from a local file ! The SpeechRecognitionAPI Needs to be hosted someway (server as http or https). Artyom will NOT work here, Sorry.";console.error(message);return{code:"artyom_error_localfile",message:message}}if(!artyom.device.isChrome){var message="Fatal Error Detected: You are not running Google Chrome ! SpeechRecognitionAPI and SpeechSynthesisAPI is only available in google chrome ! ";console.error(message);return{code:"artyom_error_browser_unsupported",message:message}}if(window.location.protocol!="https:"){console.warn("Artyom is not running in HTTPS protocol,running in protocol : "+window.location.protocol+" that means the browser will ask the permission of microphone too often. You need a HTTPS Connection if you want artyom in continuous mode !")}return false};artyom.redirectRecognizedTextOutput=function(action){if(typeof action!="function"){console.warn("Expected function to handle the recognized text ...");return false}artyomProperties.helpers.redirectRecognizedTextOutput=action;return true};artyom.sayRandom=function(data){if(data instanceof Array){var index=Math.floor(Math.random()*data.length);artyom.say(data[index]);return{text:data[index],index:index}}else{console.error("Random quotes must be in an array !");return null}};artyom.newDictation=function(settings){if(!artyom.recognizingSupported()){console.error("SpeechRecognition is not supported in this browser");return false}var dictado=new webkitSpeechRecognition;dictado.continuous=true;dictado.interimResults=true;dictado.lang=artyomProperties.lang;dictado.onresult=function(event){var temporal="";var interim="";for(var i=0;i<event.results.length;++i){if(event.results[i].final){temporal+=event.results[i][0].transcript}else{interim+=event.results[i][0].transcript}}if(settings.onResult){settings.onResult(interim,temporal)}};return new function(){var dictation=dictado;var flagStartCallback=true;var flagRestart=false;this.onError=null;this.start=function(){if(settings.continuous===true){flagRestart=true}dictation.onstart=function(){if(typeof settings.onStart==="function"){if(flagStartCallback===true){settings.onStart()}}};dictation.onend=function(){if(flagRestart===true){flagStartCallback=false;dictation.start()}else{flagStartCallback=true;if(typeof settings.onEnd==="function"){settings.onEnd()}}};dictation.start()};this.stop=function(){flagRestart=false;dictation.stop()};if(typeof settings.onError==="function"){dictation.onerror=settings.onError}}};artyom.newPrompt=function(config){if(typeof config!=="object"){console.error("Expected the prompt configuration.")}var copyActualCommands=Object.assign([],artyomCommands);artyom.emptyCommands();var promptCommand={description:"Setting the artyom commands only for the prompt. The commands will be restored after the prompt finishes",indexes:config.options,action:function(i,wildcard){artyomCommands=copyActualCommands;var toExe=config.onMatch(i,wildcard);if(typeof toExe!=="function"){console.error("onMatch function expects a returning function to be executed");return}toExe()}};if(config.smart){promptCommand.smart=true}artyom.addCommands(promptCommand);if(typeof config.beforePrompt!=="undefined"){config.beforePrompt()}artyom.say(config.question,{onStart:function(){if(typeof config.onStartPrompt!=="undefined"){config.onStartPrompt()}},onEnd:function(){if(typeof config.onEndPrompt!=="undefined"){config.onEndPrompt()}}})};artyom.extensions=function(){return{}};artyom.getNativeApi=function(){return reconocimiento};artyom.isRecognizing=function(){return artyomProperties.recognizing};artyom.isSpeaking=function(){return artyomProperties.speaking};artyom.clearGarbageCollection=function(){return artyom_garbage_collector=[]};artyom.getGarbageCollection=function(){return artyom_garbage_collector};artyom.setDebug=function(status){if(status){return artyomProperties.debug=true}else{return artyomProperties.debug=false}};artyom.dontObey=function(){return artyomProperties.obeying=false};artyom.obey=function(){return artyomProperties.obeying=true};artyom.isObeying=function(){return artyomProperties.obeying};artyom.getVersion=function(){return"1.0.5"};artyom.on=function(indexes,smart){return{then:function(action){var command={indexes:indexes,action:action};if(smart){command.smart=true}artyom.addCommands(command)}}};artyom.remoteProcessorService=function(action){artyomProperties.helpers.remoteProcessorHandler=action;return true};artyom.voiceAvailable=function(languageCode){return typeof artyomInternals.getVoice(languageCode)!=="undefined"};return artyom}if(typeof artyom==="undefined"){window.artyom=Object.preventExtensions(new Artyom)}else{console.info("Artyom has been already defined in the Window")}})(window);